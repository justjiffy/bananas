<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UAt-Compatible" content="ie=edge">
    <title>My Website</title>
    <link href="style.css">
    <link rel="stylesheet" href="./style.css">
    <link rel="icon" href="./favicon.ico" type="image/x-icon">
  </head>
  <body>
    <main>

      <div class="invitation">
        <div class="envelope">
          <div class="mask">
            <div class="card">
              <div class="face front">
                <h1><img src="https://s3-us-west-2.amazonaws.com/s.cdpn.io/39132/poke-logo.svg"/><span class="extrude">Invitation Card</span></h1>
              </div>
              <div class="face back"><img src="https://s3-us-west-2.amazonaws.com/s.cdpn.io/39132/poke-peeps.png"/></div>
            </div>
          </div>
        </div>
        <div class="flap"></div>
        <button>You're Invited!</button>
      </div>
    </main>
	<script src="index.js">
    const button = $('button');
    const envelope = $('.envelope');
    var flipped = false;

    function pullOut() {
      return new TimelineMax()
        .to('.flap', 1, {
          rotationX: 180,
          ease: Power1.easeInOut
        }, 'scaleBack')
        .to('.invitation', 1, {
          scale: 0.8,
          ease: Power4.easeInOut,
        }, 'scaleBack')
        .set('.flap', {
          zIndex: 0
        })
        .to('.card', 1, {
          y: '0%',
          scaleY: 1.2,
          ease: Circ.easeInOut,
        })
        .set('.mask', {
          //- Change overflow on mask
          overflow: 'visible',
          onComplete: function() {
            //- Change Z-Index on Pseudo element
            envelope.toggleClass('is-open');
          }
        })
        .to('.mask', 1.3, {
          'clip-path': 'inset(0 0 0% 0)',
          ease: Circ.easeInOut,
        }, 'moveDown')
        .to('.card', 1.3, {
          y: '100%',
          scaleY: 1,
          ease: Circ.easeInOut,
        }, 'moveDown')
        .to('button', 1, {
          y: '180px',
          ease: Circ.easeInOut,
          onComplete: toggleText
        }, 'moveDown+=0.15');
    }

    function toggleFlip() {
      if (!envelope.hasClass('is-open')) {
        return;
      }

      const ry = (!flipped) ? 180 : 0;
      flipped = (!flipped) ? true : false;

      TweenMax.to('.card', 1, {
        rotationY: ry,
        ease: Power4.easeInOut,
        onComplete: toggleText
      });
    }

    function toggleText() {
      var text = !flipped ? 'Tell me more!' : 'See you there!';
      button.toggleClass('invert', !flipped).text(text);
    }

    button.one('click', pullOut);
    button.on('click', toggleFlip);

  </script>
  </body>
</html>
